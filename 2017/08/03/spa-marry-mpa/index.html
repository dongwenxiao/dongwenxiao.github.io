<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8">
  <meta name="baidu-site-verification" content="code-fdh3NAiQpB" />
  

  
  <title>2017年的WEB前端开发 - 单页面终于嫁给了多页面 | 董文枭&#39;s Website</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="引言WEB 前端技术早已今非昔比，可谓是大前端。从网页上的炫酷效果，到页面的布局，再到服务端模板渲染和数据接口功能，WEB 前端技术都可以轻松搞定。甚至利用 JavaScript 可以编写很多跨界的项目，如游戏开发（Cocos2d\Unity3D）、机器学习（ConvNetJS）、跨平台应用（ReactNative）等等。 如今jQuery已成是一个优秀的古老的存在，前端技术日新月异，如果你是前端">
<meta property="og:type" content="article">
<meta property="og:title" content="2017年的WEB前端开发 - 单页面终于嫁给了多页面">
<meta property="og:url" content="http://me.websage.com/2017/08/03/spa-marry-mpa/index.html">
<meta property="og:site_name" content="董文枭&#39;s Website">
<meta property="og:description" content="引言WEB 前端技术早已今非昔比，可谓是大前端。从网页上的炫酷效果，到页面的布局，再到服务端模板渲染和数据接口功能，WEB 前端技术都可以轻松搞定。甚至利用 JavaScript 可以编写很多跨界的项目，如游戏开发（Cocos2d\Unity3D）、机器学习（ConvNetJS）、跨平台应用（ReactNative）等等。 如今jQuery已成是一个优秀的古老的存在，前端技术日新月异，如果你是前端">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://me.websage.com/assets/css-counter-note.png">
<meta property="og:image" content="http://me.websage.com/assets/isomorphic-flow.png">
<meta property="article:published_time" content="2017-08-02T16:00:00.000Z">
<meta property="article:modified_time" content="2022-12-20T08:17:46.625Z">
<meta property="article:author" content="董文枭">
<meta property="article:tag" content="技术">
<meta property="article:tag" content="koot.js">
<meta property="article:tag" content="React">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://me.websage.com/assets/css-counter-note.png">
  
    <link rel="alternate" href="/atom.xml" title="董文枭&#39;s Website" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

  <!-- <link href="https://cdn.bootcss.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet"> -->
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.10/css/all.css" integrity="sha384-+d0P83n9kaQMCwj8F4RJB66tzIwOKmrdb46+porD/OvrJ+37WqIM7UoBtwHO6Nlg" crossorigin="anonymous">
  
<meta name="generator" content="Hexo 6.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      
<header id="header"   data-log="">
  <div id="banner" class="" style=";background-color: #447fb1"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner" style="display:none;">
      <h1 id="big-title-wrap">
        <a href="/" class="big-title">董文枭&#39;s Website</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <div class="logo"><a href="/"><img src="https://avatars3.githubusercontent.com/u/4394559?s=460&v=4" alt=""></a></div>
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/about">About</a>
        
      </nav>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">


<article id="post-spa-marry-mpa" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <!-- <a href="/2017/08/03/spa-marry-mpa/" class="article-date">
  <time datetime="2017-08-02T16:00:00.000Z" itemprop="datePublished">2017-08-03</time>
</a> -->
    <!--  -->
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      2017年的WEB前端开发 - 单页面终于嫁给了多页面
    </h1>
  

      </header>
    
    <div class="article-entry " itemprop="articleBody">
      
        <h2 id="引言"><a href="#引言" class="headerlink" title="引言"></a>引言</h2><p>WEB 前端技术早已今非昔比，可谓是<code>大前端</code>。从网页上的炫酷效果，到页面的布局，再到服务端模板渲染和数据接口功能，WEB 前端技术都可以轻松搞定。甚至利用 JavaScript 可以编写很多跨界的项目，如游戏开发（<a target="_blank" rel="noopener" href="http://www.cocos.com/">Cocos2d</a>\<a target="_blank" rel="noopener" href="https://unity3d.com/cn/">Unity3D</a>）、机器学习（<a target="_blank" rel="noopener" href="http://cs.stanford.edu/people/karpathy/convnetjs/">ConvNetJS</a>）、跨平台应用（<a target="_blank" rel="noopener" href="https://facebook.github.io/react-native/">ReactNative</a>）等等。</p>
<p>如今<a target="_blank" rel="noopener" href="http://jquery.com/">jQuery</a>已成是一个优秀的古老的存在，前端技术日新月异，如果你是前端开发者，不知道：<a target="_blank" rel="noopener" href="https://facebook.github.io/react/">React</a>、<a target="_blank" rel="noopener" href="http://vuejs.org/">Vue</a>、<a target="_blank" rel="noopener" href="https://angularjs.org/">Angular</a>、<a target="_blank" rel="noopener" href="https://webpack.js.org/">Webpack</a>、<a target="_blank" rel="noopener" href="https://gulpjs.com/">Gulp</a>、<a target="_blank" rel="noopener" href="http://sass-lang.com/">Sass</a>、<a target="_blank" rel="noopener" href="http://lesscss.org/">LESS</a>、<a target="_blank" rel="noopener" href="http://postcss.org/">PostCSS</a>、<a target="_blank" rel="noopener" href="http://nodejs.cn/">NodeJS</a>、<a target="_blank" rel="noopener" href="http://koajs.com/">Koa</a>、<a target="_blank" rel="noopener" href="http://expressjs.com/">Express</a>、<a target="_blank" rel="noopener" href="http://mochajs.org/">Mocha</a>、<a target="_blank" rel="noopener" href="https://yarnpkg.com/">Yarn</a>、<a target="_blank" rel="noopener" href="http://redux.js.org/">Redux</a>、<a href="">Middleware</a>、ES6&#x2F;7、<a target="_blank" rel="noopener" href="http://www.typescriptlang.org/">TS</a>、<a target="_blank" rel="noopener" href="http://coffee-script.org/">Coffee</a>、<a target="_blank" rel="noopener" href="http://babeljs.cn/">Babel</a>等等这些词，那你真该好好学习一番了（说的不全，就这个意思吧）。</p>
<p>就本文而言，单说说网站开发这块的事儿，看看 2017 年的 WEB 技术能做到什么程度。</p>
<h2 id="技术的初衷就是解决问题"><a href="#技术的初衷就是解决问题" class="headerlink" title="技术的初衷就是解决问题"></a>技术的初衷就是解决问题</h2><p>问题的存在与技术的存在不像“先有鸡还是先有蛋”的问题那么纠结，这必然是先有问题，再有对应的技术解决此问题的。而问题的产生往往是因为我们追逐着完美，想要更优秀。在网站开发这个领域同样如此，网页是人机交互的入口，我们追求的正是响应的速度、展现的效果和使用的体验。</p>
<h2 id="那么问题就来了（先只抛砖，后面有讲解）"><a href="#那么问题就来了（先只抛砖，后面有讲解）" class="headerlink" title="那么问题就来了（先只抛砖，后面有讲解）"></a>那么问题就来了（先只抛砖，后面有讲解）</h2><h3 id="一、如何让网页响应的速度更快呢？"><a href="#一、如何让网页响应的速度更快呢？" class="headerlink" title="一、如何让网页响应的速度更快呢？"></a>一、如何让网页响应的速度更快呢？</h3><p><code>现有情况</code></p>
<p><strong>1.传统的多页面（服务端渲染 HTML）方式</strong></p>
<p>把公共部分的 JS&#x2F;CSS 引用到页面里，首次加载会下载额外的资源文件。<br>切换页面重定向的时候，整体页面刷新，很多资源被 2 次下载，并且有一段时间页面空白。</p>
<p>问题：下载了额外的资源文件，页面重定向会有空白间断。</p>
<p><strong>2.单页面 WEB 应用（SPA）方式</strong></p>
<p>把页面的基础 HTML 壳子和页面所需要的 JS&#x2F;CSS 是先下载到浏览器端，再进行 HTML 渲染，整个网页必须在引用的 JS 文件下载后，n 毫秒后显示。（即使做了 AMD 方式的分包，可以优化节省下载时间，但无法根本解决页面展现  依赖 JS 下载完成问题）</p>
<p>问题：网页的整体显示依赖于 JS 是文件下载时间。</p>
<p><code>理想情况</code></p>
<p>根据当前 URL 请求，返回对应的（完整内容）HTML 和（当前页面所需要的）CSS 以及（基础功能和当前业务）JS。<br>其中 CSS 放到页内，与 HTML 一同下载，会省了 1 条下载线程让给其他资源。（与传统方式不同  的是 CSS 没有多余的部分）<br>其中 JS 放到最后加载，不影响网页首屏的显示。<br>后续的所有页面（与本站相关的网页）都是跟进用户的动作按需加载，做异步的 JS 处理。<br>后续加载的 JS 不会重复下载。</p>
<p>总结：在首次打开页面时候排除所有可能排除的下载内容，让网页瘦成一道闪电。</p>
<h3 id="二、假如上面的理想情况实现了，后续的内容全部是-JS-加载渲染，那么-SEO-该怎么办？"><a href="#二、假如上面的理想情况实现了，后续的内容全部是-JS-加载渲染，那么-SEO-该怎么办？" class="headerlink" title="二、假如上面的理想情况实现了，后续的内容全部是 JS 加载渲染，那么 SEO 该怎么办？"></a>二、假如上面的理想情况实现了，后续的内容全部是 JS 加载渲染，那么 SEO 该怎么办？</h3><p><code>现有情况</code></p>
<p><strong>1.传统的多页面（服务端渲染 HTML）方式</strong></p>
<p>有较好的 SEO 能力，可以在 HTML 渲染时候指定多处 SEO 优化内容。</p>
<p><strong>2.单页面 WEB 应用（SPA）方式</strong></p>
<p>几乎丧失了多页面网站的 SEO 能力，也会有一些特定的方法解决，但效果跟多页面网站完全不是一个 level 的。</p>
<p><code>理想情况</code></p>
<p>我还没有更好的办法超越“多页面网站”的 SEO 能力，那就做到和它一样的 level。<br>要做到 2 点：</p>
<p>a) URL 必须返回对应的 HTML 内容<br>b) 前端开发的时候可以轻松设置 SEO 内容（如 meta、title 等）</p>
<h3 id="三、假如上面的理想情况实现了，那么作为一家国际化的公司多语言是个必不可少的功能，该如何实现呢？"><a href="#三、假如上面的理想情况实现了，那么作为一家国际化的公司多语言是个必不可少的功能，该如何实现呢？" class="headerlink" title="三、假如上面的理想情况实现了，那么作为一家国际化的公司多语言是个必不可少的功能，该如何实现呢？"></a>三、假如上面的理想情况实现了，那么作为一家国际化的公司多语言是个必不可少的功能，该如何实现呢？</h3><p><code>中小型项目</code></p>
<p>一般会编写国际化的语言变量文件，根据浏览器的设置或者用户的选择，调用不同的语言变量文件。目录结构如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">--i18n</span><br><span class="line">    |</span><br><span class="line">    +---zh.js</span><br><span class="line">    |</span><br><span class="line">    +---en.js</span><br></pre></td></tr></table></figure>

<p><code>大型项目</code></p>
<p>与中小型项目不同的是，大型项目有较多的语言变量，如果一次性加载导致速度慢，而且很多当时用不到的地方会产生流量的浪费。<br>这时候我们会做拆分，根据功能分支，做按需加载。目录结构如下：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">--i18n</span><br><span class="line">    |</span><br><span class="line">    +---feature-1</span><br><span class="line">    |   |</span><br><span class="line">    |   +---zh.js</span><br><span class="line">    |   |</span><br><span class="line">    |   +---en.js</span><br><span class="line">    |</span><br><span class="line">    |</span><br><span class="line">    +---feature-2</span><br><span class="line">        |</span><br><span class="line">        +---zh.js</span><br><span class="line">        |</span><br><span class="line">        +---en.js</span><br></pre></td></tr></table></figure>

<p>另外，还一种方式跟据语言包种类，用 Webpack 根据语音种类，打出多套程序代码进行部署，比如要支持 3 个语言，那么就生成 3 套部署代码，线上跑 3 个网站程序。这种方式是性能最好的。</p>
<h3 id="四、假如上面的多语言也实现了，公司做-Android-平台的项目那么多，我们前端同学能做什么呢？"><a href="#四、假如上面的多语言也实现了，公司做-Android-平台的项目那么多，我们前端同学能做什么呢？" class="headerlink" title="四、假如上面的多语言也实现了，公司做 Android 平台的项目那么多，我们前端同学能做什么呢？"></a>四、假如上面的多语言也实现了，公司做 Android 平台的项目那么多，我们前端同学能做什么呢？</h3><p><code>PWA</code> <a target="_blank" rel="noopener" href="https://developers.google.com/web/progressive-web-apps/">点击了解</a></p>
<p>PWA 是 Google 推出的渐进式 Web 应用程序，让 H5 在 Android 平台上增加了很多类似 APP 的功能，如推送、像应用一样放到桌面、离线使用等。</p>
<p>那么前端同学就可以利用 Google 的 API 来加强 H5 的体验。在实现的时候只是多了一些配置代码和对数据请求的特殊处理。<br>离线的核心技术就是 ServiceWorker。从开发工作量的角度来说，并不会有太多的额外工作量，<br>自己可以基于 NodeJS 来实现一套工具自动完成这件事儿。</p>
<p><code>AMP</code> <a target="_blank" rel="noopener" href="https://www.ampproject.org/learn/overview/">点击了解</a></p>
<p>AMP 也是 Google 推出的增强网页体验和增强搜索能力的方案。有点类似小程序，<br>严格要求安装他的语法格式编写网页。不一样的是他自带一个 JS 库，可以直接在浏览器上运行。</p>
<p>前端同学可以利用 AMP 的语法做出让用户更高效浏览的网站，特别适用于新闻类型的站点，Google 搜索会对 AMP 实现的网站有专项推荐。<br>从开发工作量的角度来说，会增加一些工作量，实现需要用到 AMP 特定的语法规范。</p>
<h3 id="五、假如上面的多语言也实现了，那么我们的开发效率能不能更高？"><a href="#五、假如上面的多语言也实现了，那么我们的开发效率能不能更高？" class="headerlink" title="五、假如上面的多语言也实现了，那么我们的开发效率能不能更高？"></a>五、假如上面的多语言也实现了，那么我们的开发效率能不能更高？</h3><p>说到这里，就不做比较了，前端攻城狮们或可以说“心灵手巧”，或可以说“懒到极致”，<br>近几年是不断的：发明工具-&gt;重新发明工具-&gt;重新发明工具-&gt;重新…</p>
<p>工具会减少重复劳动的好东西，必不可少，这里我会从多个角度分析，如何提高前端开发效率。</p>
<p><code>跨职能联调</code></p>
<p><strong>1.与服务端开发同学联调</strong></p>
<p>你是否工作中常听见：“他的接口还没好，等接口呢”、“页面写好了，就差套模板了”、“服务端同学又改我代码”、“等服务端同学帮我搭建环境”…</p>
<p>这些问题可以通过与服务端同学的配合方式上解决，前后端开发完全分离，让服务端同学只开发接口，更专注于数据业务逻辑和接口性能。让前端开发开发网站的非数据库部分，包括了服务端渲染和网页页面。前端同学用 NodeJS 技术做服务端开发，代码部署到与服务端代码相同的机房，这样既不会影响网站速度，又不会导致前后端开发互相影响。仅基于接口的联调会更容易测试、排除问题。（阿里早几年就已经开始这样做了）</p>
<p><strong>2.与测试同学的配合</strong></p>
<p>基于上述的开发模式，接口可以加上单元测试，避免一些低级错误的发生。<br>前端同学自己的写的逻辑性代码也可以加上“单元测试”（有精力的情况下），<br>包括页面的交互上操作也可以加上“行为测试”（有精力的情况下）。<br>这样在交 QA 同学的时候就会减少很多低级错误了。</p>
<p><code>团队开发有规范</code></p>
<ol>
<li>统一用 ES、TS、Coffee 等这些比较先进的语法</li>
<li>CSS 使用 LESS\Sass 等</li>
<li>统一编码风格，一个.eslintrc 配置文件（ESLint）就可以搞定</li>
<li>组件化开发：React\Vue...</li>
<li>适当的加上 git hook，做 code review</li>
</ol>
<p>等等这些内容现在的前端开发比较常用，不细说了。</p>
<p><code>善用工具</code></p>
<ol>
<li>WEB 前端的工具应该是最丰富的了，代码检查、合并、压缩、混淆、SourceMap、CSS 优化、各种任务预处理工具：前天的 Grunt\昨天的 Gulp\今天的 Webpack</li>
<li>开发的时候还有实时更新的工具，边写边更新页面：LiveReload、Webpack-dev-server、HMR</li>
<li>图片资源的（视觉）无损压缩处理：Tinypng</li>
<li>各种测试工具：Mocha\Karma\Jasmine</li>
<li>NodeJS 进程管理工具：PM2</li>
<li>不得不提的包管理工具：NPM(CNPM)\Yarn</li>
</ol>
<h3 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h3><ol>
<li>减少沟通成本，其实大多程序猿的 coding 速度还很快的。</li>
<li>规范和工具都是围绕着 “Don’t repeat yourself!” 这个思路来执行的。</li>
</ol>
<h2 id="把理想变成现实"><a href="#把理想变成现实" class="headerlink" title="把理想变成现实"></a>把理想变成现实</h2><p>上述的种种已实现并整理成框架，名为“super-project”，模板项目：<a target="_blank" rel="noopener" href="https://github.com/websage-team/sp-boilerplate">sp-boilerplate</a><br>框架核心：<a target="_blank" rel="noopener" href="https://github.com/websage-team/super-project">super-project</a><br>引用技术：Koa+React+Redux+Webpack（可以使用类似的技术替换，如：Express+Vue+Vuex+Browserify）</p>
<p>下面简要简介了一些技术点实现原理，涉及内容较多，不能面面俱到，想深入了解的同学请点击链接查看源码，一探究竟，或直接找我沟通。</p>
<h3 id="一、如何让网页响应的速度更快呢？让网页瘦成一道闪电"><a href="#一、如何让网页响应的速度更快呢？让网页瘦成一道闪电" class="headerlink" title="一、如何让网页响应的速度更快呢？让网页瘦成一道闪电"></a>一、如何让网页响应的速度更快呢？让网页瘦成一道闪电</h3><ol>
<li><p>准备好一份精简的 HTML 框架(跟进业务精简，酌情处理)。</p>
</li>
<li><p>利用 React+React-Router 服务端渲染的能力（自研发 Koa 服务端渲染 React 功能中间件<a target="_blank" rel="noopener" href="https://github.com/websage-team/super-project/tree/master/src/ReactApp">super-project&#x2F;ReactApp</a>），在服务端执行 React 代码，渲染出当 URL 请求对应的 HTML 片段。</p>
</li>
<li><p>用样式收集器（自研发<a target="_blank" rel="noopener" href="https://github.com/websage-team/sp-css-import">sp-css-import</a>），收集到当前 HTML 片段里（React 组件）需要的 CSS。<br>样式收集器原理，利用组件化开发的方式，把每个组件对应的 CSS 独立出来，用于引用收集，利用 React 渲染机制，在用户访问页面时，把用到的组件的 CSS 注入到收集器中，收集器在分类、压缩 CSS。在网页内运行期间，页面内部组件会根据用户的操作发生改变，组件使用次数会有全局的监听，根据页面内使用到的组件动态调整页内<code>&lt;Style /&gt;</code>标签的内容，标签内容实时对应了当前组件的 CSS 需求。参考下面图示：<br><img src="/assets/css-counter-note.png"></p>
</li>
<li><p>利用 Webpack 的打包（AMD、require.ensure）能力，把 JS 根据页面拆分，产出 1 个入口文件和 N 个页面相关的 JS 文件，这样入口文件会根据当前的 URL 判断加载哪些页面逻辑相关的 JS 文件。</p>
</li>
<li><p>最后把收集好的 CSS 插入到 HTML 框架头部，把 React 渲染好的 HTML 插入到内容体，把入口 JS 文件链接放到页尾，返回给浏览器。</p>
</li>
</ol>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">+------------------------------------------------+</span><br><span class="line">|   HTML 精简结构                                 |</span><br><span class="line">|                                                |</span><br><span class="line">|       +--------------------------------+       |</span><br><span class="line">|       |       CSS (页内 CSS &lt;style&gt;)    |       |</span><br><span class="line">|       +--------------------------------+       |</span><br><span class="line">|       |       React-HTML               |       |</span><br><span class="line">|       +--------------------------------+       |</span><br><span class="line">|       |      JS Link (只有 JS 入口文件)  |       |</span><br><span class="line">|       +--------------------------------+       |</span><br><span class="line">|                                                |</span><br><span class="line">+------------------------------------------------+</span><br></pre></td></tr></table></figure>

<h3 id="二、那么-SEO-该怎么办？让网页首次打开带有完整的-HTML-代码"><a href="#二、那么-SEO-该怎么办？让网页首次打开带有完整的-HTML-代码" class="headerlink" title="二、那么 SEO 该怎么办？让网页首次打开带有完整的 HTML 代码"></a>二、那么 SEO 该怎么办？让网页首次打开带有完整的 HTML 代码</h3><ol>
<li><p>主体内容的完整性在上一个问题解决的同时（步骤 2）也被解决了。</p>
</li>
<li><p>自定义的 meta 其实是与 react 逻辑脱离的，写前端业务的同学不容易接触到 NodeJS 相关代码。我的解决方案是在 React 组件上扩展了 onServerRender 的事件，当服务端运行 React 逻辑的时候，会自动检测该事件并执行，在 onServerRender 事件里暴露自定义 meta 的相关方法，从而为前端开发者开放了编写 meta 的能力。onServerRender 事件里还暴露了一些自定义 HTML 的方法，以便扩展 HTML 内容。</p>
</li>
</ol>
<p>注：网上流行的说法是把 React Server Render 叫成“同构”，为了让大家更容易理解这种方式，我画了一个访问流程图示例：</p>
<p><img src="/assets/isomorphic-flow.png"></p>
<p>说明：</p>
<ol>
<li><p>多页面站点浏览方式<br>用户直接访问目标页面，页面 A 与页面 B 直接是跳转 URL 的方式（整体刷新）。</p>
</li>
<li><p>单页面站点浏览方式<br>不管用户访问的是哪个 URL，都返回相同的框架页内容（无内容），在浏览器端用 JS 判断跳转显示目标页面，后续的页面跳转，都是 JS 做的，无需刷新页面。</p>
</li>
<li><p>同构站点浏览方式<br>用户直接访问目标页面，每个目标页面都可以作为框架页（类似单页面的框架页），在后续的页面跳转，都是用 JS 做的，无需刷新页面。</p>
</li>
</ol>
<h3 id="三、上面是思路，可根据具体情况选择方案。"><a href="#三、上面是思路，可根据具体情况选择方案。" class="headerlink" title="三、上面是思路，可根据具体情况选择方案。"></a>三、上面是思路，可根据具体情况选择方案。</h3><h3 id="四、PWA-和-AMP"><a href="#四、PWA-和-AMP" class="headerlink" title="四、PWA 和 AMP"></a>四、PWA 和 AMP</h3><ol>
<li>PWA 我们已经针对当前的项目架构做出了自动化工具，可查看源码 <a target="_blank" rel="noopener" href="https://github.com/websage-team/sp-pwa">sp-pwa</a></li>
<li>AMP 目前没法自动化，只能根据业务做开发。</li>
</ol>
<h3 id="五、开发工具和-Webpack-配置在模板项目里已存在，感兴趣的请仔细查看、尝试"><a href="#五、开发工具和-Webpack-配置在模板项目里已存在，感兴趣的请仔细查看、尝试" class="headerlink" title="五、开发工具和 Webpack 配置在模板项目里已存在，感兴趣的请仔细查看、尝试"></a>五、开发工具和 Webpack 配置在模板项目里已存在，感兴趣的请仔细查看、尝试</h3><p><a target="_blank" rel="noopener" href="https://github.com/websage-team/super-project">https://github.com/websage-team/super-project</a></p>
<h2 id="小试牛刀"><a href="#小试牛刀" class="headerlink" title="小试牛刀"></a>小试牛刀</h2><p>super-project 已经应用到两个项目上了，点击下面链接，亲手体验一下“单页面嫁给多页面”（同构）的 feel~<br>（时间就了也许会因为业务停止而打不开）</p>
<p><code>PhotoGrid Share H5</code></p>
<p><a target="_blank" rel="noopener" href="http://photogrid.cmcm.com/posts/rnR8C9Xg78MNHDU5TrXOOQ%3D%3D?f=profile-GW3Y75kQ+kFshbCpnXV7WEj5b02+SC8n/gFxM6Sx72E=">例子 - 详情页面</a><br><a target="_blank" rel="noopener" href="http://photogrid.cmcm.com/profile/OOUqewXJPwKn2qg%2BRFGgo1qoC2UfoTvLlifSZd6%2BOfM%3D">例子 - 列表页面</a></p>
<p><code>News Republic Site</code></p>
<p><a target="_blank" rel="noopener" href="https://news.cmcm.com/">例子 - 首页</a><br><a target="_blank" rel="noopener" href="https://news.cmcm.com/detail/03EAFABEFA10100001_us">例子 - 详情页面</a></p>
<h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><p>综上所述，是我个人经验的整理和融合，让网站即有 SPA 的体验又不失 SEO 的能力（单页面嫁给了多页面）。发掘所有能提高用户体验的方式，将优化进行到底。后续我和团队还会继续优化 super-project 框架，下一个解决的问题就是升级框架的成本变低，使用框架的成本变低，是针对业务开发者使用上的体验优化。</p>
<p>欢迎感兴趣的朋友随时探讨。</p>

      
    </div>
    <div class="article-more ">...</div>
    <footer class="article-footer">
      <span class="article-footer-date">2017-08-03</span>
      <!-- <a data-url="http://me.websage.com/2017/08/03/spa-marry-mpa/" data-id="clbvzdqrr000563chfqr0f9wl" class="article-share-link">Share</a> -->
      
      
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/React/" rel="tag">React</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/koot-js/" rel="tag">koot.js</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/%E6%8A%80%E6%9C%AF/" rel="tag">技术</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2018/04/19/sp-boilerplate/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          sp-boilerplate (super-project 模板项目)(废弃)
        
      </div>
    </a>
  
  
    <a href="/2016/10/01/hello-hexo/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Hello Hexo</div>
    </a>
  
</nav>

  
</article>


</section>
        <aside class="toc-sticky" id="sidebar">
  
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">目录</h3>
    <div class="widget">
      <div class="hidden-xs col-sm-3 toc-col">
        <div class="toc-wrap">
            <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%95%E8%A8%80"><span class="toc-text">引言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8A%80%E6%9C%AF%E7%9A%84%E5%88%9D%E8%A1%B7%E5%B0%B1%E6%98%AF%E8%A7%A3%E5%86%B3%E9%97%AE%E9%A2%98"><span class="toc-text">技术的初衷就是解决问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%82%A3%E4%B9%88%E9%97%AE%E9%A2%98%E5%B0%B1%E6%9D%A5%E4%BA%86%EF%BC%88%E5%85%88%E5%8F%AA%E6%8A%9B%E7%A0%96%EF%BC%8C%E5%90%8E%E9%9D%A2%E6%9C%89%E8%AE%B2%E8%A7%A3%EF%BC%89"><span class="toc-text">那么问题就来了（先只抛砖，后面有讲解）</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%A6%82%E4%BD%95%E8%AE%A9%E7%BD%91%E9%A1%B5%E5%93%8D%E5%BA%94%E7%9A%84%E9%80%9F%E5%BA%A6%E6%9B%B4%E5%BF%AB%E5%91%A2%EF%BC%9F"><span class="toc-text">一、如何让网页响应的速度更快呢？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E5%81%87%E5%A6%82%E4%B8%8A%E9%9D%A2%E7%9A%84%E7%90%86%E6%83%B3%E6%83%85%E5%86%B5%E5%AE%9E%E7%8E%B0%E4%BA%86%EF%BC%8C%E5%90%8E%E7%BB%AD%E7%9A%84%E5%86%85%E5%AE%B9%E5%85%A8%E9%83%A8%E6%98%AF-JS-%E5%8A%A0%E8%BD%BD%E6%B8%B2%E6%9F%93%EF%BC%8C%E9%82%A3%E4%B9%88-SEO-%E8%AF%A5%E6%80%8E%E4%B9%88%E5%8A%9E%EF%BC%9F"><span class="toc-text">二、假如上面的理想情况实现了，后续的内容全部是 JS 加载渲染，那么 SEO 该怎么办？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E5%81%87%E5%A6%82%E4%B8%8A%E9%9D%A2%E7%9A%84%E7%90%86%E6%83%B3%E6%83%85%E5%86%B5%E5%AE%9E%E7%8E%B0%E4%BA%86%EF%BC%8C%E9%82%A3%E4%B9%88%E4%BD%9C%E4%B8%BA%E4%B8%80%E5%AE%B6%E5%9B%BD%E9%99%85%E5%8C%96%E7%9A%84%E5%85%AC%E5%8F%B8%E5%A4%9A%E8%AF%AD%E8%A8%80%E6%98%AF%E4%B8%AA%E5%BF%85%E4%B8%8D%E5%8F%AF%E5%B0%91%E7%9A%84%E5%8A%9F%E8%83%BD%EF%BC%8C%E8%AF%A5%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E5%91%A2%EF%BC%9F"><span class="toc-text">三、假如上面的理想情况实现了，那么作为一家国际化的公司多语言是个必不可少的功能，该如何实现呢？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9B%E3%80%81%E5%81%87%E5%A6%82%E4%B8%8A%E9%9D%A2%E7%9A%84%E5%A4%9A%E8%AF%AD%E8%A8%80%E4%B9%9F%E5%AE%9E%E7%8E%B0%E4%BA%86%EF%BC%8C%E5%85%AC%E5%8F%B8%E5%81%9A-Android-%E5%B9%B3%E5%8F%B0%E7%9A%84%E9%A1%B9%E7%9B%AE%E9%82%A3%E4%B9%88%E5%A4%9A%EF%BC%8C%E6%88%91%E4%BB%AC%E5%89%8D%E7%AB%AF%E5%90%8C%E5%AD%A6%E8%83%BD%E5%81%9A%E4%BB%80%E4%B9%88%E5%91%A2%EF%BC%9F"><span class="toc-text">四、假如上面的多语言也实现了，公司做 Android 平台的项目那么多，我们前端同学能做什么呢？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E5%81%87%E5%A6%82%E4%B8%8A%E9%9D%A2%E7%9A%84%E5%A4%9A%E8%AF%AD%E8%A8%80%E4%B9%9F%E5%AE%9E%E7%8E%B0%E4%BA%86%EF%BC%8C%E9%82%A3%E4%B9%88%E6%88%91%E4%BB%AC%E7%9A%84%E5%BC%80%E5%8F%91%E6%95%88%E7%8E%87%E8%83%BD%E4%B8%8D%E8%83%BD%E6%9B%B4%E9%AB%98%EF%BC%9F"><span class="toc-text">五、假如上面的多语言也实现了，那么我们的开发效率能不能更高？</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%80%BB%E7%BB%93%EF%BC%9A"><span class="toc-text">总结：</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8A%8A%E7%90%86%E6%83%B3%E5%8F%98%E6%88%90%E7%8E%B0%E5%AE%9E"><span class="toc-text">把理想变成现实</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E3%80%81%E5%A6%82%E4%BD%95%E8%AE%A9%E7%BD%91%E9%A1%B5%E5%93%8D%E5%BA%94%E7%9A%84%E9%80%9F%E5%BA%A6%E6%9B%B4%E5%BF%AB%E5%91%A2%EF%BC%9F%E8%AE%A9%E7%BD%91%E9%A1%B5%E7%98%A6%E6%88%90%E4%B8%80%E9%81%93%E9%97%AA%E7%94%B5"><span class="toc-text">一、如何让网页响应的速度更快呢？让网页瘦成一道闪电</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%8C%E3%80%81%E9%82%A3%E4%B9%88-SEO-%E8%AF%A5%E6%80%8E%E4%B9%88%E5%8A%9E%EF%BC%9F%E8%AE%A9%E7%BD%91%E9%A1%B5%E9%A6%96%E6%AC%A1%E6%89%93%E5%BC%80%E5%B8%A6%E6%9C%89%E5%AE%8C%E6%95%B4%E7%9A%84-HTML-%E4%BB%A3%E7%A0%81"><span class="toc-text">二、那么 SEO 该怎么办？让网页首次打开带有完整的 HTML 代码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%89%E3%80%81%E4%B8%8A%E9%9D%A2%E6%98%AF%E6%80%9D%E8%B7%AF%EF%BC%8C%E5%8F%AF%E6%A0%B9%E6%8D%AE%E5%85%B7%E4%BD%93%E6%83%85%E5%86%B5%E9%80%89%E6%8B%A9%E6%96%B9%E6%A1%88%E3%80%82"><span class="toc-text">三、上面是思路，可根据具体情况选择方案。</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9B%9B%E3%80%81PWA-%E5%92%8C-AMP"><span class="toc-text">四、PWA 和 AMP</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BA%94%E3%80%81%E5%BC%80%E5%8F%91%E5%B7%A5%E5%85%B7%E5%92%8C-Webpack-%E9%85%8D%E7%BD%AE%E5%9C%A8%E6%A8%A1%E6%9D%BF%E9%A1%B9%E7%9B%AE%E9%87%8C%E5%B7%B2%E5%AD%98%E5%9C%A8%EF%BC%8C%E6%84%9F%E5%85%B4%E8%B6%A3%E7%9A%84%E8%AF%B7%E4%BB%94%E7%BB%86%E6%9F%A5%E7%9C%8B%E3%80%81%E5%B0%9D%E8%AF%95"><span class="toc-text">五、开发工具和 Webpack 配置在模板项目里已存在，感兴趣的请仔细查看、尝试</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%B0%8F%E8%AF%95%E7%89%9B%E5%88%80"><span class="toc-text">小试牛刀</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E8%AF%AD"><span class="toc-text">结语</span></a></li></ol>
        </div>
      </div>
    </div>
  </div>


  
</aside>
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2022 董文枭<br>
      Powered by <a href="http://hexo.io/" target="_blank" rel="nofollow">Hexo</a> &amp; Theme by <a target="_blank" href="https://github.com/dongwenxiao/dongwenxiao.github.io/tree/src/themes/codemonkey" rel="nofollow noopener">Codemoney</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/about" class="mobile-nav-link">About</a>
  
</nav>
    

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/app.js"></script>


<script src="/js/script.js"></script>




  </div>
</body>
</html>

<!-- Baidu auto push js -->
<script>
  ;(function(){
      var bp = document.createElement('script');
      var curProtocol = window.location.protocol.split(':')[0];
      if (curProtocol === 'https') {
          bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
      }
      else {
          bp.src = 'http://push.zhanzhang.baidu.com/push.js';
      }
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(bp, s);
  })();
</script>

<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-137365876-3"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'UA-137365876-3');
</script>
